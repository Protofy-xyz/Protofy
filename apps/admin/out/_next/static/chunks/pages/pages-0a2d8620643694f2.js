(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2158],{68918:function(e,t,a){"use strict";a.d(t,{d:function(){return l}});var r=a(78161),o=a(2784),s=a(87656),n=a(52322);let i=e=>{let{color:t="black",size:a=24,...r}=e;return(0,n.jsxs)(s.Svg,{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:`${t}`,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[(0,n.jsx)(s.Path,{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",stroke:`${t}`}),(0,n.jsx)(s.Polyline,{points:"15 3 21 3 21 9",stroke:`${t}`}),(0,n.jsx)(s.Line,{x1:"10",x2:"21",y1:"14",y2:"3",stroke:`${t}`})]})};i.displayName="ExternalLink";let l=(0,o.memo)((0,r.H)(i))},60574:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(56626);let o=(0,r.Z)("DatabaseZap",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 15 21.84",key:"14ibmq"}],["path",{d:"M21 5V8",key:"1marbg"}],["path",{d:"M21 12L18 17H22L19 22",key:"zafso"}],["path",{d:"M3 12A9 3 0 0 0 14.59 14.87",key:"1y4wr8"}]])},58254:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(56626);let o=(0,r.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},40006:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(56626);let o=(0,r.Z)("PencilRuler",[["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M13 7 8.7 2.7a2.41 2.41 0 0 0-3.4 0L2.7 5.3a2.41 2.41 0 0 0 0 3.4L7 13",key:"orapub"}],["path",{d:"m8 6 2-2",key:"115y1s"}],["path",{d:"m2 22 5.5-1.5L21.17 6.83a2.82 2.82 0 0 0-4-4L3.5 16.5Z",key:"hes763"}],["path",{d:"m18 16 2-2",key:"ee94s4"}],["path",{d:"m17 11 4.3 4.3c.94.94.94 2.46 0 3.4l-2.6 2.6c-.94.94-2.46.94-3.4 0L11 17",key:"cfq27r"}]])},49437:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(56626);let o=(0,r.Z)("Router",[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]])},17165:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pages",function(){return a(17208)}])},17208:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return W}});var r=a(52322),o=a(52725),s=a(13997),n=a(48115),i=a(99361),l=a(50897),c=a(71932),d=a(79562),u=a(1888),_=a(30195),p=a(52026),m=a(89929),x=a(53763),b=a(8939),f=a(68918),h=a(89560),j=a(82695),w=a(6429),g=a(2784),v=a(6289),y=a(26887),k=a(5632),N=a(51813),P=a(80330),z=a(1780),$=a(57643),C=a(82614),Z=a(91838),F=a(22287),S=a(66306),q=a(70396);let A=e=>{var t;let{template:a,isSelected:o,onPress:s,theme:n}=e,[i,l]=(0,g.useState)(!1),c="/images/templates/".concat(a.id,"-").concat(n,".png");return(0,r.jsx)(Z.I,{children:(0,r.jsxs)(b.FA,{id:"pages-template-"+a.id,onPress:s,onHoverIn:()=>l(!0),onHoverOut:()=>l(!1),overflow:"hidden",borderWidth:o?"$1":"$0.5",borderColor:o?"$color7":"$gray8",cursor:"pointer",borderRadius:"$3",children:[(0,r.jsx)(F.E,{source:{height:180,width:357,uri:c}}),(0,r.jsx)("div",{className:(0,q.concatClassName)(" _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _mih-0px _miw-0px _fs-0  _zi-10000 _pos-absolute _r-1481558214 _t-1481558214  "+(i?" _dsp-block":" _dsp-none")),children:(0,r.jsx)(C.p,{target:"_blank",href:c,children:(0,r.jsx)(S.zx,{backgroundColor:"$color7",size:"$1.5",borderRadius:"$1",px:"$2",textProps:{size:"$1"},onPress:e=>{e.stopPropagation()},children:"preview"})})}),(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _jc-441309761 _btw-1481558338 _btc-791969557 _brc-791969557 _bbc-791969557 _blc-791969557 _bg-791969402 _pt-1481558276 _pb-1481558276 _pr-1481558214 _pl-1481558214 _bts-solid ",children:(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",children:null!==(t=a.name)&&void 0!==t?t:a.id})})]})})};a(57117);var I=a(81974),L=a(36701);let M={},V="/adminapi/v1/pages",E="/adminapi/v1/objects?all=1",H=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _jc-center _ai-center _gap-25px _fw-wrap ",children:t})},D=e=>{let{selected:t,setSelected:a}=e,o=(0,p.useThemeName)();return(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:[(0,r.jsx)(m.p,{mah:"500px",children:(0,r.jsx)(H,{children:Object.entries(L.H).map(e=>{let[s,n]=e;return(0,r.jsx)(A,{theme:o,template:n,isSelected:t===s,onPress:()=>a(s)})})})}),(0,r.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-1316330176 _miw-1316330176 _fs-0 _w-1316330176 _h-1316330176 _pe-none _mb-1316330331 "})]})},O=e=>{let{data:t,setData:a,error:s,setError:n,objects:i}=e;return(0,r.jsx)(z.G,{externalErrorHandling:!0,error:s,setError:n,data:t,setData:a,name:"page",numColumns:2,mode:"add",title:"",model:o.L,extraFields:L.H[t.data.template].extraFields?L.H[t.data.template].extraFields(i):{}})};var T={pages:{component:e=>{var t;let{pageState:a,initialItems:u,pageSession:m,extraData:w}=e,z={data:{web:!0,electron:!1,protected:!1,template:"blank"}};(0,k.useRouter)();let{replace:C}=(0,j.N)(a),[Z,F]=(0,g.useState)(null!==(t=null==w?void 0:w.objects)&&void 0!==t?t:(0,v.E)("pending")),[S,A]=(0,g.useState)(!1);(0,p.useThemeName)();let[H,T]=(0,g.useState)(z),R=(0,x.Py)(),[B,W]=(0,g.useState)("");(0,$.rf)(()=>{W(""),T(z)},[S]),(0,y.a)(e=>{n.bl.get({url:E},e)},F,null==w?void 0:w.objects);let U=e=>{let t=I.T[document.location.hostname.split(".")[0]];return t&&t.baseUrl?t.baseUrl+e:e};return(0,r.jsxs)(i.D,{title:"Pages",pageSession:m,children:[(0,r.jsx)(N.a,{integratedChat:!0,p:"$2",pt:"$5",pl:"$5",setOpen:A,open:S,hideAccept:!0,description:"",children:(0,r.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _jc-center _ai-center ",children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1316330238 ",children:(0,r.jsx)(P.M,{lastButtonCaption:"Create",onFinish:async()=>{try{let e=o.L.load(H.data);if(L.H[H.data.template].extraValidation){let e=L.H[H.data.template].extraValidation(H.data);if(null==e?void 0:e.error)throw e.error}let t=await n.bl.post(V,e.create().getData());if(t.isError)throw t.error;A(!1),R.show("Page created",{message:e.getId()})}catch(e){console.log("original error: ",e),W((0,v.E)("error",null,e instanceof _.z.ZodError?e.flatten():e))}},slides:[{name:"Create new page",title:"Select your Template",component:(0,r.jsx)(D,{selected:null==H?void 0:H.data.template,setSelected:e=>T({...H,data:{...H.data,template:e}})})},{name:"Configure your page",title:"Configure your page",component:(0,r.jsx)(O,{error:B,objects:Z,setError:W,data:H,setData:T})}]})})})}),(0,r.jsx)(s.V,{integratedChat:!0,sourceUrl:V,initialItems:u,numColumnsForm:2,name:"page",rowIcon:()=>(0,r.jsx)(r.Fragment,{}),objectProps:{columnWidth:500},columns:l.Z.columns(l.Z.column("",()=>"",!1,e=>(0,r.jsx)("a",{href:U(e.route.startsWith("/")?e.route:"/"+e.route),target:"_blank",children:(0,r.jsx)(c.z,{Icon:f.d})}),!0,"50px"),l.Z.column("name",e=>e.name,"name",e=>(0,r.jsx)(b.sL,{id:"pages-datatable-"+e.name,children:(0,r.jsx)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px ",children:e.name})})),l.Z.column("route",e=>e.route,"route"),l.Z.column("visibility",e=>e.protected,"protected",e=>e.protected?(0,r.jsx)(d.A,{text:"protected",color:"$gray5"}):(0,r.jsx)(d.A,{text:"public",color:"$color5"})),l.Z.column("permissions",e=>e.permissions,"permissions",e=>e.permissions.map((e,t)=>(0,r.jsx)("div",{className:(0,q.concatClassName)(" _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  "+(t?" _ml-10px":" _ml-0px")),children:(0,r.jsx)(d.A,{text:e,color:"$gray5"})},t)))),onAddButton:()=>{A(!0)},extraMenuActions:[{text:"Edit Page file",icon:h.z,action:e=>{C("editFile",e.getDefaultFilePath())},isVisible:e=>!0}],model:o.L,pageState:a,icons:M})]})},getServerSideProps:(0,u.eq)(V,["admin"],{},async e=>({objects:await n.bl.get((0,w.VM)(E,e))}))}};a(68415);var R=a(97729),B=a.n(R);function W(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B(),{children:(0,r.jsx)("title",{children:"Protofy - Pages"})}),(0,r.jsx)(T.pages.component,{...e})]})}},36701:function(e,t,a){"use strict";a.d(t,{H:function(){return c},e:function(){return l}});var r=a(30195),o=a(40006),s=a(49437),n=a(60574),i=a(58254);let l={"custom-api":{id:"custom-api",name:"Automation",description:"Create automations that react to events and perform actions (when ..., do ...)",icon:o.Z},"iot-router":{id:"iot-router",name:"IOT Router",description:"Create automations to control IoT devices and react to IoT events",icon:s.Z},"automatic-crud":{id:"automatic-crud",name:"Object storage",description:"Create automations to store and retrieve objects from database",icon:n.Z,extraFields:e=>({object:r.z.union([r.z.literal("without object"),...e.data.items.map(e=>r.z.literal(e.name))]).after("name")}),extraValidation:e=>{if(!Object.keys(e).includes("object"))return{error:"object cant be empty"}}},"automatic-crud-storage":{id:"automatic-crud-storage",name:"Object storage (custom database)",description:"Create automations to store and retrieve objects with custom database",icon:i.Z,extraFields:e=>({object:r.z.union([r.z.literal("without object"),...e.data.items.map(e=>r.z.literal(e.name))]).after("name")}),extraValidation:e=>{if(!Object.keys(e).includes("object"))return{error:"object cant be empty"}}}},c={blank:{id:"blank",name:"Blank"},default:{id:"default",name:"Default"},admin:{name:"Admin panel",id:"admin",extraFields:e=>{var t;return{object:r.z.union([...e&&e.data?null===(t=e.data)||void 0===t?void 0:t.items.filter(e=>e.features&&e.features.AutoAPI).map(e=>r.z.literal(e.name)):[]]).after("route")}},extraValidation:e=>{if(!Object.keys(e).includes("object"))return{error:"object cant be empty"}}},landing:{id:"landing",name:"Landing"},iot:{id:"iot",name:"IoT Panel"},ecomerce:{id:"ecomerce",name:"E-commerce"},about:{id:"about",name:"About"},newsfeed:{id:"newsfeed",name:"News feed"}}},52725:function(e,t,a){"use strict";a.d(t,{L:function(){return i}});var r=a(30195),o=a(75370),s=a(54283);let n=o.V_.object({name:r.z.string().search().id(),route:r.z.string().search(),permissions:r.z.array(r.z.string()).label("Permissions").generate(()=>[]),web:r.z.boolean().defaultValue(!0),electron:r.z.boolean().defaultValue(!1),protected:r.z.boolean().defaultValue(!1).label("Require user")});class i extends s.J{getDefaultFilePath(){return"/packages/app/bundles/custom/pages/"+this.data.name+".tsx"}static _newInstance(e,t){return new i(e,t)}constructor(e,t){super(e,n,t,"Page")}}},79562:function(e,t,a){"use strict";a.d(t,{A:function(){return l}});var r=a(52322),o=a(2784),s=a(8939),n=a(60545),i=a(70396);let l=e=>{let{loading:t,icon:a,text:l,bold:c,color:d,...u}=e;return(0,r.jsxs)(s.sL,{ai:"center",jc:"center",bc:null!=d?d:"$color5",p:2,px:"$3",br:25,...u,children:[a&&o.cloneElement(a,{size:20,strokeWidth:.7,color:"var(--color)"}),l&&(0,r.jsx)("span",{className:(0,i.concatClassName)("  is_SizableText _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px   _o-0d0t9746  _col-675002279 _ff-299667014 _fow-233016047 _ls-167743966 _fos-229441127 _lh-222976480 font_body  "+(a?" _ml-1481558214":" _ml-1481558400")+" "+(c?" _fow-900":" _fow-400")),children:l}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-9px _miw-9px _fs-0 _pe-none _w-9px _h-9px "}),(0,r.jsx)(n.$,{color:"var(--color8)",scale:.7,size:"small"})]})]})};a(71619)},80330:function(e,t,a){"use strict";a.d(t,{M:function(){return c}});var r=a(52322),o=a(8939),s=a(66306),n=a(2784),i=a(91838);let l="  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fow-500 _fos-16px _col-791969588 ",c=e=>{let{slides:t,lastButtonCaption:a,onFinish:c,id:d="pages"}=e,[u,_]=(0,n.useState)(0),p=t.length,m=u>1?u-1:0,x=u<p-1?u+1:null,b=t.filter((e,t)=>t<=u).map(e=>e.name).join(" / ");return(0,r.jsxs)(o.FA,{id:"admin-dataview-create-dlg",w:800,mah:700,p:"$3",f:1,children:[(0,r.jsxs)(o.sL,{id:"admin-eo",mt:"$4",justifyContent:"space-between",width:"100%",children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 ",children:(0,r.jsx)("span",{className:l,children:b})}),(0,r.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _ai-flex-end ",children:(0,r.jsxs)("span",{className:l,children:["[",u+1,"/",p,"]"]})})]}),(0,r.jsx)(i.I,{children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fow-600 _fos-34px _col-549765294 ",children:t[u].title})})}),(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mt-1316330269 ",children:t[u].component}),(0,r.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _gap-40px _jc-center _mb-1316330238 _fg-1 _ai-flex-end ",children:[0!==u?(0,r.jsx)(s.zx,{w:250,onPress:e=>{e.stopPropagation(),u>0&&_(m)},children:"Back"}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(i.I,{children:(0,r.jsx)(s.zx,{id:"admin-"+d+"-add-btn",w:250,onPress:async e=>{e.stopPropagation(),x?_(x):c&&await c()},children:p===u+1?a:"Next"})})]})]})};a(88538)},1888:function(e,t,a){"use strict";a.d(t,{F7:function(){return n},eq:function(){return i}});var r=a(46149),o=a(6429),s=a(48115);let n=e=>r.l.SSR?e:void 0;function i(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(async n=>{var i,l,c,d,u,_;let p={itemsPerPage:parseInt(n.query.itemsPerPage)?parseInt(n.query.itemsPerPage):"",page:parseInt(n.query.page,10)?parseInt(n.query.page,10):"",search:null!==(i=n.query.search)&&void 0!==i?i:"",orderBy:null!==(l=n.query.orderBy)&&void 0!==l?l:"",orderDirection:null!==(c=n.query.orderDirection)&&void 0!==c?c:"",view:null!==(d=n.query.view)&&void 0!==d?d:"",item:null!==(u=n.query.item)&&void 0!==u?u:"",editFile:null!==(_=n.query.editFile)&&void 0!==_?_:"",..."function"==typeof a?await a(n):a},m="function"==typeof e?e(n):e;return(0,o.NA)(n,t,{sourceUrl:m,initialItems:await s.bl.get({url:(0,o.VM)(m,n),...p}),itemData:n.query.item?await s.bl.get((0,o.VM)(m+"/"+n.query.item,n)):"",extraData:{..."function"==typeof r?await r(n):r},pageState:{...p}})})}},57117:function(){},88538:function(){},68415:function(){},71619:function(){}},function(e){e.O(0,[8641,8081,4733,1335,8873,2859,6313,3950,7499,4718,5278,986,1004,1823,2029,1698,9774,2888,179],function(){return e(e.s=17165)}),_N_E=e.O()}]);